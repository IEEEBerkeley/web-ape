<link rel="icon" type="image/png" sizes="64x64 96x96 128x128" href="{{ '/assets/images/ape.png' | relative_url }}">
<link rel="preload" href="{{ '/assets/css/just-the-docs-dark.css' | relative_url }}" as="style" />

<!-- Intentionally duplicates the default theme stylesheet so there's a fallback when changing themes -->
<link id="jtdThemeCSS" rel="stylesheet" href="{{ '/assets/css/just-the-docs-default.css' | relative_url }}">

<script>
  /* Script to enable persistent dark mode. */

  jtd.getTheme = function() {
    var cssFileHref = (document.getElementById('jtdThemeCSS') || document.querySelector('[rel="stylesheet"]')).getAttribute('href');
    return cssFileHref.substring(cssFileHref.lastIndexOf('-') + 1, cssFileHref.length - 4);
  }

  jtd.setTheme = function(theme) {
    var cssFile = document.getElementById('jtdThemeCSS') || document.querySelector('[rel="stylesheet"]');
    cssFile.setAttribute('href', cssFile.getAttribute('href').replace(jtd.getTheme(), theme));
  }

  let toggleDark = () => {
    let setDark = jtd.getTheme() !== 'dark';
    document.documentElement.setAttribute(
      'data-theme',
      setDark ? 'dark' : 'default',
    );
    document.documentElement.setAttribute(
      'data-theme',
      setDark ? 'dark' : 'default',
    );
    jtd.setTheme(setDark ? 'dark' : 'default');
    localStorage.setItem('darkMode', String(setDark));
  };

  if (localStorage.getItem('darkMode') === 'true') {
    toggleDark();
  }
</script>

<!-- Script for LaTeX rendering. -->
<link rel="stylesheet" href="{{ '/assets/katex/katex.min.css' | relative_url }}">
<script defer src="{{ '/assets/katex/katex.min.js' | relative_url }}"></script>
<script>
function renderKaTeX() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false},
      {left: '\\(', right: '\\)', display: false},
      {left: '\\[', right: '\\]', display: true},
    ],
  });
}
</script>
<script defer src="{{ '/assets/katex/contrib/auto-render.min.js' | relative_url }}" onload="renderKaTeX();"></script>

<script>
  // Mark syllabus timeline cells with content so CSS can color only filled ones
  document.addEventListener('DOMContentLoaded', () => {
    const rows = document.querySelectorAll('#timeline tr');
    rows.forEach(row => {
      const cells = row.querySelectorAll('td');
      if (cells.length >= 6) {
        const mappings = [
          { index: 3, cls: 'filled-lab' },
          { index: 4, cls: 'filled-checkoff' },
          { index: 5, cls: 'filled-project' },
        ];
        mappings.forEach(({ index, cls }) => {
          const td = cells[index];
          if (td && td.textContent.trim().length > 0) {
            td.classList.add(cls);
          }
        });
      }
    });
  });
</script>
